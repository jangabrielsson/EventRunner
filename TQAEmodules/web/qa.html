<html>
<head>
<h1>QuickApp {{{ local qa = EM.getQA(opts.id); out(qa.name)}}}</h1>
<style>
table, td, th {
  border: 1px solid black;
}

table {
  border-collapse: collapse;
  width: 100%;
}

td {
  height: 50px;
  text-align: left;
  vertical-align: top;
}
</style>
<script>
 function myFunction(id) { document.getElementById(id).submit(); }
</script>
</head>
<body>
{{{
local qa = EM.getQA(opts.id)
    out("<ul>")
    out("<li>DeviceID: %s</li>",qa.id)
    out("<li>Type: %s</li>",qa.type)
    out("<li>BaseType: %s</li>",EM.Devices[qa.id].baseType or "no base type")
    out("<li>Interfaces: %s</li>",FB.json.encode(qa.interfaces))
    out("</ul>")
}}}
<button onclick="window.location.href='/TQAE/lua?{{{out("EM.QAs[%s].env.plugin.restart()",opts.id)}}}'">Restart</button>
<button onclick="window.location.href='/TQAE/lua?{{{out("EM.saveFQA(EM.QAs[%s])",opts.id)}}}'">Save</button>
<table>
<tr><th>View</th><th>Methods</th><th>Properties</th><th>QuickAppVariables</th></tr>
<tr><td>
{{{
    local qa = EM.getQA(opts.id)
    out("<ul>")
    for elm,e in pairs(qa._view) do
      out("<li>%s",elm)
      out("<ul>")
      for tp,v in pairs(e) do
        out("<li>%s = %s</li>",tp,v)
      end
      out("</ul></li>")
    end
    out("</ul>")
}}}
</td>
<td>
{{{ 
     local qa,fs = EM.getQA(opts.id),{}
     for k,v in pairs(qa) do
       if type(v)=='function' and k~="__copyObject" then fs[#fs+1]=k end
     end
     table.sort(fs)
     for i,n in ipairs(fs) do
       out('<form id="M%s" action="TQAE/method" method="GET">',i)
       out('<a href="#" onclick="myFunction(\'%s\')">self:%s</a>',"M"..i,n)
       out('<input type="hidden" id="M%s" name="qaID" value="%s">',i,opts.id)
       out('<input type="hidden" id="M%s" name="method" value="%s">',i,n)
       out('<input type="text" name="Args" id="Args" /></form>')
     end
}}}
</td>
<td>
{{{ 
     local qa,fs = EM.getQA(opts.id),{}
     local excludes={quickAppVariables=true,viewLayout=true}
     for k,v in pairs(qa.properties) do if not excludes[k] then fs[#fs+1]={k,v} end end
     table.sort(fs,function(a,b) return a[1] < b[1] end)
     for _,n in ipairs(fs) do out("<li>%s = %s</li>",n[1],FB.json.encode(n[2])) end
}}}
</td>
<td>
{{{ 
     local qa,vars = EM.getQA(opts.id),{}
     for _,v in ipairs(qa.properties.quickAppVariables or {}) do vars[#vars+1]=v end
     table.sort(vars,function(a,b) return a.name < b.name end)
     for _,v in ipairs(vars) do 
       out("<li>%s = %s</li>",v.name,v.value)
     end
}}}
</td>
</tr>
</table>
{{{ html.home(out) }}}
</body>
</html>